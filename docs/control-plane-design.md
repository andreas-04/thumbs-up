┌──────────────────────────────────────────────────────────────────────┐
│                    CONTROL PLANE NODE                                │
│              (Your Laptop / Cloud Server - K3s Master)               │
├──────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  ┌─────────────────────────────────────────────────────────────────┐ │
│  │            K3s Control Plane Components (Built-in)              │ │
│  │  ┌────────────┬───────────────┬──────────────┬────────────────┐ │ │
│  │  │ API Server │  Controller   │  Scheduler   │ etcd (embedded)│ │ │
│  │  │            │   Manager     │              │                │ │ │
│  │  └────────────┴───────────────┴──────────────┴────────────────┘ │ │
│  └─────────── ─────────────────────────────────────────────────────┘ │
│                                                                      │
│  ┌─────────────────────────────────────────────────────────────────┐ │
│  │                   Your Custom Pods (Namespace: thumbsup)        │ │
│  │                                                                 │ │
│  │  ┌───────────────────────────────────────────────────────────┐  │ │
│  │  │  Pod: thumbsup-backend                                    │  │ │
│  │  │  ┌─────────────────────────────────────────────────────┐  │  │ │
│  │  │  │  Container: go-api                                  │  │  │ │
│  │  │  │  • Go web server (Gin/Fiber)                        │  │  │ │
│  │  │  │  • Device registry API                              │  │  │ │
│  │  │  │  • Certificate Authority                            │  │  │ │
│  │  │  │  • RBAC policy management                           │  │  │ │
│  │  │  │  Port: 8000                                         │  │  │ │
│  │  │  └─────────────────────────────────────────────────────┘  │  │ │
│  │  │  ┌─────────────────────────────────────────────────────┐  │  │ │
│  │  │  │  Container: postgres (sidecar)                      │  │  │ │
│  │  │  │  • PostgreSQL database                              │  │  │ │
│  │  │  │  Port: 5432                                         │  │  │ │
│  │  │  └─────────────────────────────────────────────────────┘  │  │ │
│  │  └───────────────────────────────────────────────────────────┘  │ │
│  │                                                                 │ │
│  │  ┌───────────────────────────────────────────────────────────┐  │ │
│  │  │  Pod: thumbsup-frontend                                   │  │ │
│  │  │  ┌─────────────────────────────────────────────────────┐  │  │ │
│  │  │  │  Container: react-ui                                │  │  │ │
│  │  │  │  • nginx serving static React build                 │  │  │ │
│  │  │  │  • Admin dashboard UI                               │  │  │ │
│  │  │  │  Port: 80                                           │  │  │ │
│  │  │  └─────────────────────────────────────────────────────┘  │  │ │
│  │  └───────────────────────────────────────────────────────────┘  │ │
│  │                                                                 │ │
│  │  ┌───────────────────────────────────────────────────────────┐  │ │
│  │  │  Deployment: nfs-operator                                 │  │ │
│  │  │  ┌─────────────────────────────────────────────────────┐  │  │ │
│  │  │  │  Container: operator                                │  │  │ │
│  │  │  │  • Watches for RBAC ConfigMap changes               │  │  │ │
│  │  │  │  • Reconciles NFS exports across Pis                │  │  │ │
│  │  │  │  • Go controller with K8s client                    │  │  │ │
│  │  │  └─────────────────────────────────────────────────────┘  │  │ │
│  │  └───────────────────────────────────────────────────────────┘  │ │
│  │                                                                 │ │
│  │  ┌───────────────────────────────────────────────────────────┐  │ │
│  │  │  Service: thumbsup-backend (ClusterIP)                    │  │ │
│  │  │  • Exposes backend API within cluster                     │  │ │
│  │  │  • Port: 8000                                             │  │ │
│  │  └───────────────────────────────────────────────────────────┘  │ │
│  │                                                                 │ │
│  │  ┌───────────────────────────────────────────────────────────┐  │ │
│  │  │  Ingress: thumbsup-ingress                                │  │ │
│  │  │  • Routes external traffic                                │  │ │
│  │  │  • / → frontend                                           │  │ │
│  │  │  • /api/* → backend                                       │  │ │
│  │  └───────────────────────────────────────────────────────────┘  │ │
│  └──────────────────────────────────────────────────────────────────┘ │
│                                                                        │
└────────────────────────────────────────────────────────────────────────┘
                                  ▲
                                  │ K3s Agent Connection
                 ┌────────────────┼────────────────┬───────────────────┐
                 │                │                │                   │
┌────────────────▼─────┐  ┌───────▼────────┐  ┌───▼──────────────┐   
│   DATA PLANE NODE 1  │  │ DATA PLANE     │  │ DATA PLANE       │  
│   (Raspberry Pi)     │  │ NODE 2 (Pi)    │  │ NODE 3 (Pi)      │   
│   K3s Agent          │  │ K3s Agent      │  │ K3s Agent        │   
├──────────────────────┤  ├────────────────┤  ├──────────────────┤   
│                      │  │                │  │                  │   
│  ┌────────────────┐  │  │  ┌──────────┐  │  │  ┌────────────┐  │   
│  │ DaemonSet Pod  │  │  │  │DaemonSet │  │  │  │ DaemonSet  │  │   
│  │ file-sync      │  │  │  │file-sync │  │  │  │ file-sync  │  │   
│  │                │  │  │  │          │  │  │  │            │  │   
│  │ Container:     │  │  │  │Container:│  │  │  │ Container: │  │   
│  │ • sync-agent   │  │  │  │sync-agent│  │  │  │ sync-agent │  │   
│  │ • Watches etcd │◄─┼──┼──┼─ etcd ───┼──┼──┼──┼─ Shared    │  │   
│  │ • rsync files  │  │  │  │          │  │  │  │            │  │   
│  └────────────────┘  │  │  └──────────┘  │  │  └────────────┘  │   
│                      │  │                │  │                  │   
│  ┌────────────────┐  │  │  ┌──────────┐  │  │  ┌────────────┐  │   
│  │ Pod:           │  │  │  │ Pod:     │  │  │  │ Pod:       │  │   
│  │ thumbsup-nas   │  │  │  │thumbsup- │  │  │  │ thumbsup-  │  │   
│  │                │  │  │  │nas       │  │  │  │ nas        │  │   
│  │ Container:     │  │  │  │Container:│  │  │  │ Container: │  │   
│  │ • Python NAS   │  │  │  │Python NAS│  │  │  │ Python NAS │  │   
│  │ • mTLS auth    │  │  │  │          │  │  │  │            │  │   
│  │ • NFS server   │  │  │  │          │  │  │  │            │  │   
│  │ • Firewall     │  │  │  │          │  │  │  │            │  │   
│  │ Port: 8443     │  │  │  │          │  │  │  │            │  │   
│  │ Port: 2049     │  │  │  │          │  │  │  │            │  │   
│  └────────────────┘  │  │  └──────────┘  │  │  └────────────┘  │   
│  /mnt/luks0          │  │                │  │                  │   
│  (HostPath volume)   │  │  (HostPath)    │  │  (HostPath)      │  
└──────────────────────┘  └────────────────┘  └──────────────────┘   
                                                                   
         ▲                     ▲                     ▲               
         │                     │                     │               
         └─────────────────────┴─────────────────────┘               
                    Client Devices (mTLS + NFS)                       
                                                                      