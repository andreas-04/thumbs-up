stateDiagram-v2
    [*] --> WAITING_FOR_CONNECTION

    WAITING_FOR_CONNECTION --> HANDSHAKE_INITIATED

    HANDSHAKE_INITIATED --> CERTIFICATE_VALIDATION

    CERTIFICATE_VALIDATION --> AUTHENTICATED
    CERTIFICATE_VALIDATION --> REJECTED

    AUTHENTICATED --> ACCESS_GRANTED

    ACCESS_GRANTED --> ACCESS_GRANTED
    ACCESS_GRANTED --> SESSION_ENDED

    SESSION_ENDED --> WAITING_FOR_CONNECTION

    REJECTED --> WAITING_FOR_CONNECTION

    WAITING_FOR_CONNECTION --> [*]